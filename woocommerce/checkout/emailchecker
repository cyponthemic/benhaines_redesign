<?php
if (! is_user_logged_in() ):
?>
    <input type="hidden" ng-init="clc.emailAddressPostData = '<?php echo $_POST['username']?>' ; ">
    Debug
    post <?php echo $_POST['username']?>

    {{clc.emailAddressPostData === ''}}
    {{!clc.isReturning}}
    {{!clc.isReturning && clc.emailAddressPostData === undefined}}

    <div ng-cloak="" ng-if="!clc.isReturning && !clc.emailChecked && clc.emailAddressPostData === ''">
        <p>

            Please enter your email address to continue to delivery and payment.
        </p>
        <form id="formEmailChecker">
            <input ng-prevent-form-on-enter
                   type="text"
                   id="check-email"
                   required
                   ng-value="clc.getEmailAddressFromPost()"
                   ng-model="clc.emailAddress"
                   ng-keyup="$event.keyCode == 13 && clc.emailAddress ? clc.checkAddress() : null"  >
            <a class="button check-username"
               ng-disabled="clc.emailAddress === undefined"
               ng-click="clc.checkAddress()"
            >Continue</a>
        </form>
    </div>
    <div ng-cloak="" ng-if="clc.isReturning && clc.emailChecked">
        <?php
            woocommerce_login_form_custom(
                array(
                    'message'  => __( 'Thank you for returning to the shop, please enter your password to continue', 'woocommerce' ),
                    'redirect' => wc_get_page_permalink( 'checkout' ),
                    'hidden'   => false
                )
            );

        ?>
    </div>
        <?php
        endif;
        ?>

